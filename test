# Folder containing PowerPoint files
$folderPath = "C:\Reports\PPTs"

# Text to replace
$oldMonth = "November"
$newMonth = "December"

# Start PowerPoint
$pptApp = New-Object -ComObject PowerPoint.Application
$pptApp.Visible = [Microsoft.Office.Core.MsoTriState]::msoFalse

# Get all PPT and PPTX files
$pptFiles = Get-ChildItem -Path $folderPath -Include *.ppt, *.pptx -File

foreach ($file in $pptFiles) {
    Write-Host "Processing $($file.Name)..."

    $presentation = $pptApp.Presentations.Open($file.FullName, $true, $false, $false)

    foreach ($slide in $presentation.Slides) {
        foreach ($shape in $slide.Shapes) {

            if ($shape.HasTextFrame -and $shape.TextFrame.HasText) {
                $textRange = $shape.TextFrame.TextRange

                if ($textRange.Text -match $oldMonth) {
                    $textRange.Text = $textRange.Text -replace $oldMonth, $newMonth
                }
            }
        }
    }

    # Save changes
    $presentation.Save()
    $presentation.Close()
}

# Close PowerPoint
$pptApp.Quit()

# Cleanup COM objects
[System.Runtime.InteropServices.Marshal]::ReleaseComObject($pptApp) | Out-Null
[GC]::Collect()
[GC]::WaitForPendingFinalizers()

Write-Host "All PowerPoint files updated successfully."
